!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("causal-net.core"),require("causal-net.utils")):"function"==typeof define&&define.amd?define(["causal-net.core","causal-net.utils"],t):"object"==typeof exports?exports["@causalNet/optimizers"]=t(require("causal-net.core"),require("causal-net.utils")):e["@causalNet/optimizers"]=t(e["causal-net.core"],e["causal-net.utils"])}(this,function(e,t){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(t,r){t.exports=e},function(e,t,r){var n,a,o;a=[t],void 0===(o="function"==typeof(n=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=e=>(class extends e{fit(e,t){return this.trainer.minimize(e,!0,t)}});e.default=t})?n.apply(t,a):n)||(e.exports=o)},function(e,r){e.exports=t},function(e,t,r){var n,a,o;a=[t,r(5),r(9),r(10)],void 0===(o="function"==typeof(n=function(e,t,n,a){"use strict";var o=r(0);Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"causalNetSGDOptimizer",{enumerable:!0,get:function(){return t.causalNetSGDOptimizer}}),Object.defineProperty(e,"TrainerMixins",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"EvaluatorMixins",{enumerable:!0,get:function(){return a.default}}),n=o(n),a=o(a)})?n.apply(t,a):n)||(e.exports=o)},function(e,t,r){var n,a,o;a=[t,r(6),r(2)],void 0===(o="function"==typeof(n=function(e,t,n){"use strict";var a=r(0);Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"causalNetSGDOptimizer",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"SGDFitParamsMixins",{enumerable:!0,get:function(){return n.default}}),t=a(t),n=a(n)})?n.apply(t,a):n)||(e.exports=o)},function(e,t,r){var n,a,o;a=[t,r(7),r(1),r(3),r(2)],void 0===(o="function"==typeof(n=function(e,t,n,a,o){"use strict";var i=r(0);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,t=i(t),o=i(o);var s=new class extends(a.platform.mixWith(n.Tensor,[o.default])){constructor(){super()}adam(e){return new t.default(e)}};e.default=s})?n.apply(t,a):n)||(e.exports=o)},function(e,t,r){var n,a,o;a=[t,r(1),r(3),r(8),r(2)],void 0===(o="function"==typeof(n=function(e,t,n,a,o){"use strict";var i=r(0);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a=i(a),o=i(o),e.default=class extends(n.platform.mixWith(t.Tensor,[o.default])){constructor(e={}){super();const{learningRate:t,beta1:r,beta2:n,epsilon:o}=a.default.mergeParams(e,{beta1:.1,beta2:.2,epsilon:.03});this.params={learningRate:t,beta1:r,beta2:n,epsilon:o},this.trainer=this.T.train.adam(t,r,n,o)}get Params(){return this.params}}})?n.apply(t,a):n)||(e.exports=o)},function(e,t,r){var n,a,o;a=[t,r(1)],void 0===(o="function"==typeof(n=function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=new class extends t.Functor{constructor(){super()}mergeParams(e,t){const r=this.R;return r.mergeDeepLeft(e,t)}};e.default=r})?n.apply(t,a):n)||(e.exports=o)},function(e,t,r){var n,a,o;a=[t],void 0===(o="function"==typeof(n=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=e=>(class extends e{get Trainer(){const e=this.T,t=this.LossModel,r=this.Optimizer;return(n,a)=>r.fit(()=>e.tidy(()=>t(n,a)))}get Optimizer(){if(!this.optimizer)throw Error("optimizer is not set");return this.optimizer}set Optimizer(e){this.optimizer=e}get TrainDataGenerator(){if(!this.trainDataGenerator)throw Error("TrainDataGenerator is not set");return this.trainDataGenerator}set TrainDataGenerator(e){this.trainDataGenerator=e}async train(e,t){const r=this.F,n=this.F.CoreFunctor,a=this.T,o=this.TrainDataGenerator,i=this.Trainer;let s=[],u=this.Logger;return new Promise(async(f,c)=>{u.progressBegin(e);for(let f of r.range(e)){const r=o(t);let c=[];for await(let e of r){let{samples:t,labels:r}=e,n=a.tensor(t).asType("float32"),o=a.tensor(r).asType("float32"),s=i(n,o);c.push(await s.data())}s.push(n.mean(c)),c=[],u.progressUpdate({epochIdx:f,losses:s,numEpochs:e})}u.progressEnd(),f({losses:s})})}setByConfig(e){super.setByConfig&&super.setByConfig(e),this.Logger.groupBegin("set Trainer by config");const{Optimizer:t}=e.Net;this.Optimizer=t,t.LayerRunner=this.LayerRunner,this.TrainDataGenerator=e.Dataset.TrainDataGenerator,this.Logger.groupEnd()}});e.default=t})?n.apply(t,a):n)||(e.exports=o)},function(e,t,r){var n,a,o;a=[t],void 0===(o="function"==typeof(n=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=e=>(class extends e{get TestDataGenerator(){if(!this.testDataGenerator)throw Error("testDataGenerator is not set");return this.testDataGenerator}set TestDataGenerator(e){this.testDataGenerator=e}async test(e=32){const t=this.T,r=this.F.CoreFunctor,n=this.TestDataGenerator,a=this.OneHotPredictModel;return new Promise(async(o,i)=>{const s=n(e);let u=[];for await(let e of s){let{samples:r,labels:n}=e,o=t.tensor(r).asType("float32"),i=t.tensor(n).asType("float32"),s=a(o),f=s.mul(i);u=[...u,...await f.sum(1).data()]}let f=r.mean(u);o({accuracy:f,pass:u})})}setByConfig(e){super.setByConfig&&super.setByConfig(e),this.Logger.groupBegin("set Evaluator by config"),this.TestDataGenerator=e.Dataset.TestDataGenerator,this.Logger.groupEnd()}});e.default=t})?n.apply(t,a):n)||(e.exports=o)}])});
//# sourceMappingURL=optimizers.node.js.map