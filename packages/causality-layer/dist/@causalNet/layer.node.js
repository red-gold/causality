!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("causal-net.core"),require("causal-net.utils"),require("causal-net.storage")):"function"==typeof define&&define.amd?define(["causal-net.core","causal-net.utils","causal-net.storage"],r):"object"==typeof exports?exports["@causalNet/layer"]=r(require("causal-net.core"),require("causal-net.utils"),require("causal-net.storage")):e["@causalNet/layer"]=r(e["causal-net.core"],e["causal-net.utils"],e["causal-net.storage"])}(this,function(e,r,t){return function(e){var r={};function t(a){if(r[a])return r[a].exports;var s=r[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,t),s.l=!0,s.exports}return t.m=e,t.c=r,t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:a})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var s in e)t.d(a,s,function(r){return e[r]}.bind(null,s));return a},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=3)}([function(r,t){r.exports=e},function(e,t){e.exports=r},function(e,r){e.exports=t},function(e,r,t){"use strict";t.r(r);var a=t(0),s=t(1);var i=e=>(class extends e{dense(e,r,t="sigmoid",a=null){return a||(a=this.nameGenerator("dense")),{Name:a,Type:"Layer",Parameters:{Weight:[e,r],Bias:[r]},Net:(e,r)=>{let{Weight:a,Bias:s}=r,i=e.dot(a).add(s);return{result:i=i[t](),trace:{}}}}}});var n=new class extends(s.platform.mixWith(a.Tensor,[i])){constructor(){super(),this.layerNames=[]}nameGenerator(e){let r=e+"/"+this.layerNames.length;return this.layerNames.push(r),r}},o=t(2);var u=e=>(class extends e{get PredictParameters(){if(!this.parameters||!this.parameters.Predict)throw Error("parameters is not set");return this.parameters.Predict}get EncodeParameters(){if(!this.parameters||!this.parameters.Encode)throw Error("parameters is not set");return this.parameters.Encode}get DecodeParameters(){if(!this.parameters||!this.parameters.Decode)throw Error("parameters is not set");return this.parameters.Decode}set PredictParameters(e){this.parameters=this.parameters?this.parameters:{},this.parameters.Predict=e}set EncodeParameters(e){this.parameters=this.parameters?this.parameters:{},this.parameters.Encode=e}set DecodeParameters(e){this.parameters=this.parameters?this.parameters:{},this.parameters.Decode=e}set ParameterSizes(e){this.parameterSizes=e}get ParameterSizes(){if(!this.parameterSizes)throw Error("parameterSizes is not set");return this.parameterSizes}get SaveModelDir(){return"saveModel/"}exportParameters(){if(!this.parameters)throw Error("parameter is not set");return(async()=>await this.extractParamFromTensorDict(this.parameters,async e=>Array.from(await e.data())))()}async extractParamFromTensorDict(e,r){const t=this.R,a=async(e,r)=>{if(this.isTensor(e))return await r(e);{let s=t.toPairs(e),i={};for(let[e,t]of s)i[e]=await a(t,r);return i}};return await a(e,r)}async parametersSummary(){if(!this.parameters)throw Error("parameter must be set");return await this.extractParamFromTensorDict(this.parameters,async e=>Array.from(await e.mean().data()))}initParamSizesByLayers(e){const r=this.R,t=(this.T,this.F),a=r.compose(r.fromPairs,r.map(e=>[e.Name,e.Parameters])),s=a(t.getIn(["Predict"],e,[])),i=a(t.getIn(["Encode"],e,[])),n=a(t.getIn(["Decode"],e,[]));this.ParameterSizes={PredictSize:s,EncodeSize:i,DecodeSize:n}}importParameters(e){const r=this.T,t=this.F;let a=t.getIn(["Predict"],e,{}),s=t.getIn(["Encode"],e,{}),i=t.getIn(["Decode"],e,{});const{PredictSize:n,EncodeSize:o,DecodeSize:u}=this.ParameterSizes,c=(e,a)=>t.parameterMapWithKey((e,t)=>{let s=this.F.getIn(e,a,null);return null===s?r.variable(r.randomNormal(t).asType("float32")):r.variable(r.tensor(s,t,"float32"))},e);this.PredictParameters=c(n,a),this.EncodeParameters=c(o,s),this.DecodeParameters=c(u,i)}InitParameters(e={}){return r=>this.setOrInitParams(r,e)}setOrInitParams(e,r){return this.initParamSizesByLayers(e),this.importParameters(r),this}async getSavedParamList(){const e=this.Storage,r=this.SaveModelDir;return(await e.getFileList(r)).map(e=>e.replace(r,""))}async saveParams(e){const r=this.SaveModelDir,t=this.Storage;let a=await this.exportParameters();return await t.writeFile(r+e,JSON.stringify(a)),a}async loadParams(e){const r=this.Storage,t=this.SaveModelDir;let a=await r.readFile(t+e),s=JSON.parse(a);return this.importParameters(s),this}});var c=e=>(class extends e{isParameter(e){const r=this.R;return r.ifElse(r.is(Array),r.all(r.is(Number)),r.always(!1))(e)}parameterMapWithKey(e,r){const t=this.R,a=(r,s)=>t.compose(t.fromPairs,t.map(([s,i])=>this.isParameter(i)?[s,e([...r,s],i)]:t.is(Object,i)?[s,a([...r,s],i)]:[s,i]),t.toPairs)(s);return a([],r)}});var m=new class extends(s.platform.mixWith(a.Functor,[c])){constructor(){super()}};var l=new class extends(s.platform.mixWith(a.Tensor,[o.StorageMixins,u])){constructor(e,r){super(),this.parameters=null,this.Storage=e,this.F=r,this.R=this.F.CoreFunctor}}(o.indexDBStorage,m);var h=e=>(class extends e{set NetParameters(e){this.netParameters=e}set NetLayers(e){this.netLayers=e}get NetParameters(){if(!this.netParameters)throw Error("netParameters is not set");return this.netParameters}get NetLayers(){if(!this.netLayers)throw Error("netLayers is not set");return this.netLayers}runOpFlow(e,r,t){const a=this.R,s=a.addIndex(a.reduce)(a.__,{result:e,trace:{}},r);var{result:i,trace:n}=s(({result:e,trace:r},a,s)=>{if(a.Parameter){let r=t[a.Parameter];e=e[a.Op](r,...a.Args)}else e=e[a.Op](...a.Args);return r[s]=e.shape,{result:e,trace:r}});return{result:i,trace:n}}runOpLayer(e,r,t){let{result:a,trace:s}=r(e,t);return{result:a,trace:s}}runLayer(e,r,t){const{Name:a,Type:s,Flow:i,Net:n}=r;if("Tensor"===s){let{result:r,trace:s}=this.runOpFlow(e,i,t);return{[a]:r,trace:s}}if("Layer"===s){let{result:r,trace:s}=this.runOpLayer(e,n,t);return{[a]:r,trace:s}}throw Error("type must be either Layer or Tensor")}tracing(e,r,t){e&&e.push({[r]:t})}run(e,r,t,a=null){let s={PipeInput:r},i="PipeInput";for(let r of e){let e=this.runLayer(s[i],r,t[r.Name]);s[r.Name]=e[r.Name],i=r.Name,this.tracing(a,r.Name,e.trace)}return a&&this.logger.debug({traces:a}),s[i]}get Predictor(){let e=this.NetLayers.Predict;const r=()=>this.NetParameters.PredictParameters;return t=>{let a=r();return this.run(e,t,a)}}get Encoder(){let e=this.NetLayers.Encode;const r=()=>this.NetParameters.EncodeParameters;return t=>{let a=r();return this.run(e,t,a)}}get Decoder(){let e=this.NetLayers.Decode;const r=()=>this.NetParameters.EncodeParameters;return t=>{let a=r();return this.run(e,t,a)}}});var p=new class extends(s.platform.mixWith(a.Tensor,[h])){constructor(){super()}};var d=e=>(class extends e{async saveParams(e){return await this.LayerRunner.NetParameters.saveParams(e),this}async loadParams(e){return this.LayerRunner.NetParameters=await this.LayerRunner.NetParameters.loadParams(e),this}async getSavedParamList(){return await this.LayerRunner.NetParameters.getSavedParamList()}get ParameterInitializer(){if(!this.parameterInitializer)throw Error("ParameterInitializer is not set");return this.parameterInitializer}set ParameterInitializer(e){this.parameterInitializer=e}setByConfig(e){super.setByConfig&&super.setByConfig(e),this.Logger.groupBegin("set LayerRunner by config");const{Net:r}=e,{Layers:t,Parameters:a}=r;this.LayerRunner.NetLayers=t,this.ParameterInitializer=a,this.LayerRunner.NetParameters=this.ParameterInitializer(t),this.Logger.groupEnd()}set LayerRunner(e){this.layerRunner=e}get LayerRunner(){if(!this.layerRunner)throw Error("layerRunner is not set");return this.layerRunner}});t.d(r,"causalNetLayers",function(){return n}),t.d(r,"causalNetParameters",function(){return l}),t.d(r,"ParameterMixins",function(){return u}),t.d(r,"ParameterFunctorMixins",function(){return c}),t.d(r,"causalNetRunner",function(){return p}),t.d(r,"RunnerMixins",function(){return h}),t.d(r,"LayerRunnerMixins",function(){return d})}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AY2F1c2FsTmV0L2xheWVyL3dlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIndlYnBhY2s6Ly9AY2F1c2FsTmV0L2xheWVyL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0BjYXVzYWxOZXQvbGF5ZXIvZXh0ZXJuYWwgXCJjYXVzYWwtbmV0LmNvcmVcIiIsIndlYnBhY2s6Ly9AY2F1c2FsTmV0L2xheWVyL2V4dGVybmFsIFwiY2F1c2FsLW5ldC51dGlsc1wiIiwid2VicGFjazovL0BjYXVzYWxOZXQvbGF5ZXIvZXh0ZXJuYWwgXCJjYXVzYWwtbmV0LnN0b3JhZ2VcIiIsIndlYnBhY2s6Ly9AY2F1c2FsTmV0L2xheWVyLy4vc3JjL0NhdXNhbE5ldExheWVycy9kZW5zZS5taXhpbnMuanMiLCJ3ZWJwYWNrOi8vQGNhdXNhbE5ldC9sYXllci8uL3NyYy9DYXVzYWxOZXRMYXllcnMvY2F1c2FsTmV0TGF5ZXJzLmpzIiwid2VicGFjazovL0BjYXVzYWxOZXQvbGF5ZXIvLi9zcmMvQ2F1c2FsTmV0UGFyYW1ldGVycy9wYXJhbWV0ZXIubWl4aW5zLmpzIiwid2VicGFjazovL0BjYXVzYWxOZXQvbGF5ZXIvLi9zcmMvQ2F1c2FsTmV0UGFyYW1ldGVycy9wYXJhbWV0ZXJGdW5jdG9yLm1peGlucy5qcyIsIndlYnBhY2s6Ly9AY2F1c2FsTmV0L2xheWVyLy4vc3JjL0NhdXNhbE5ldFBhcmFtZXRlcnMvcGFyYW1ldGVyRnVuY3Rvci5qcyIsIndlYnBhY2s6Ly9AY2F1c2FsTmV0L2xheWVyLy4vc3JjL0NhdXNhbE5ldFBhcmFtZXRlcnMvY2F1c2FsTmV0UGFyYW1ldGVycy5qcyIsIndlYnBhY2s6Ly9AY2F1c2FsTmV0L2xheWVyLy4vc3JjL0NhdXNhbE5ldFJ1bm5lci9ydW5uZXIubWl4aW5zLmpzIiwid2VicGFjazovL0BjYXVzYWxOZXQvbGF5ZXIvLi9zcmMvQ2F1c2FsTmV0UnVubmVyL2NhdXNhbE5ldFJ1bm5lci5qcyIsIndlYnBhY2s6Ly9AY2F1c2FsTmV0L2xheWVyLy4vc3JjL2xheWVyUnVubmVyLm1peGlucy5qcyIsIndlYnBhY2s6Ly9AY2F1c2FsTmV0L2xheWVyLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsInJlcXVpcmUiLCJkZWZpbmUiLCJhbWQiLCJ0aGlzIiwiX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMF9fIiwiX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMV9fIiwiX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMl9fIiwiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIkRlbnNlTGF5ZXJNaXhpbnMiLCJQaXBlbGluZUNsYXNzIiwiZGVuc2UiLCJpbnB1dFNpemUiLCJvdXRwdXRTaXplIiwiYWN0aXZhdG9yIiwibmFtZUdlbmVyYXRvciIsIk5hbWUiLCJUeXBlIiwiUGFyYW1ldGVycyIsIldlaWdodCIsIkJpYXMiLCJOZXQiLCJwYXJhbXMiLCJyZXN1bHQiLCJkb3QiLCJhZGQiLCJ0cmFjZSIsImNhdXNhbE5ldExheWVycyIsInBsYXRmb3JtIiwibWl4V2l0aCIsIkJhc2VUZW5zb3IiLCJEZW5zZU1peGlucyIsImNvbnN0cnVjdG9yIiwic3VwZXIiLCJsYXllck5hbWVzIiwibGF5ZXJUeXBlIiwibmV3TmFtZSIsImxlbmd0aCIsInB1c2giLCJQYXJhbWV0ZXJNaXhpbnMiLCJCYXNlUGFyYW1ldGVyQ2xhc3MiLCJQcmVkaWN0UGFyYW1ldGVycyIsInBhcmFtZXRlcnMiLCJQcmVkaWN0IiwiRXJyb3IiLCJFbmNvZGVQYXJhbWV0ZXJzIiwiRW5jb2RlIiwiRGVjb2RlUGFyYW1ldGVycyIsIkRlY29kZSIsInByZWRpY3RQYXJhbWV0ZXJzIiwiZW5jb2RlUGFyYW1ldGVycyIsImRlY29kZVBhcmFtZXRlcnMiLCJQYXJhbWV0ZXJTaXplcyIsInBhcmFtZXRlclNpemVzIiwiU2F2ZU1vZGVsRGlyIiwiZXhwb3J0UGFyYW1ldGVycyIsImV4dHJhY3RQYXJhbUZyb21UZW5zb3JEaWN0IiwiYXN5bmMiLCJBcnJheSIsImZyb20iLCJwYXJhbSIsImRhdGEiLCJbb2JqZWN0IE9iamVjdF0iLCJmbiIsIlIiLCJUcmF2ZWxsZXIiLCJpc1RlbnNvciIsImtWYWxzIiwidG9QYWlycyIsInJlcyIsImsiLCJ2YWwiLCJtZWFuIiwiaW5pdFBhcmFtU2l6ZXNCeUxheWVycyIsImxheWVycyIsIkYiLCJUIiwiR2V0UGFyYW1TaXplIiwiY29tcG9zZSIsImZyb21QYWlycyIsIm1hcCIsIlByZWRpY3RTaXplIiwiZ2V0SW4iLCJFbmNvZGVTaXplIiwiRGVjb2RlU2l6ZSIsImltcG9ydFBhcmFtZXRlcnMiLCJwYXJhbU9iamVjdCIsInByZWRpY3RQYXJhbU9iamVjdCIsImVuY29kZVBhcmFtT2JqZWN0IiwiZGVjb2RlUGFyYW1PYmplY3QiLCJTZXRPckluaXQiLCJpbml0UHJlZGljdCIsInBhcmFtZXRlck1hcFdpdGhLZXkiLCJrZXlzIiwicGFyYW1TaXplIiwicGFyYW1WYWx1ZSIsInZhcmlhYmxlIiwicmFuZG9tTm9ybWFsIiwiYXNUeXBlIiwidGVuc29yIiwiSW5pdFBhcmFtZXRlcnMiLCJzZXRPckluaXRQYXJhbXMiLCJTdG9yYWdlIiwiU2F2ZURpciIsImdldEZpbGVMaXN0IiwiZmlsZU5hbWUiLCJyZXBsYWNlIiwid3JpdGVGaWxlIiwiSlNPTiIsInN0cmluZ2lmeSIsInN0clBhcmFtcyIsInJlYWRGaWxlIiwicGFyc2UiLCJQYXJhbWV0ZXJGdW5jdG9yTWl4aW5zIiwiRnVuY3RvckNsYXNzIiwiaXNQYXJhbWV0ZXIiLCJpZkVsc2UiLCJpcyIsImFsbCIsIk51bWJlciIsImFsd2F5cyIsInBhcmFtZXRlck9iamVjdCIsIlJlcyIsInN1Yk9iamVjdCIsInBhcmFtZXRlckZ1bmN0b3IiLCJCYXNlRnVuY3RvciIsImNhdXNhbE5ldFBhcmFtZXRlcnMiLCJTdG9yYWdlTWl4aW5zIiwic3RvcmFnZSIsInBhcmFtZXRlcmZ1bmN0b3IiLCJDb3JlRnVuY3RvciIsImluZGV4REJTdG9yYWdlIiwiUnVubmVyTWl4aW5zIiwiQmFzZVJ1bm5lckNsYXNzIiwiTmV0UGFyYW1ldGVycyIsIm5ldFBhcmFtZXRlcnMiLCJOZXRMYXllcnMiLCJuZXRMYXllcnMiLCJydW5PcEZsb3ciLCJmbG93IiwiT3BzUnVubmVyIiwiYWRkSW5kZXgiLCJyZWR1Y2UiLCJfXyIsIm5vZGUiLCJpZHgiLCJQYXJhbWV0ZXIiLCJPcCIsIkFyZ3MiLCJzaGFwZSIsInJ1bk9wTGF5ZXIiLCJuZXQiLCJydW5MYXllciIsImxheWVyQ29uZmlndXJlIiwibGF5ZXJQYXJhbWV0ZXJzIiwiRmxvdyIsInRyYWNpbmciLCJ0cmFjZXMiLCJydW4iLCJzYW1wbGVzIiwicGlwZVZhbHVlIiwiUGlwZUlucHV0IiwibGFzdExheWVyIiwibGF5ZXIiLCJsYXllck91dHB1dCIsImxvZ2dlciIsImRlYnVnIiwiUHJlZGljdG9yIiwicHJlZGljdExheWVycyIsIlByZWRpY3RQYXJhbWV0ZXJzTGVuc2VzIiwiRW5jb2RlciIsImVuY29kZUxheWVycyIsIkVuY29kZVBhcmFtZXRlcnNMZW5zZXMiLCJEZWNvZGVyIiwiZGVjb2RlTGF5ZXJzIiwiRGVjb2RlUGFyYW1ldGVyc0xlbnNlcyIsImNhdXNhbE5ldFJ1bm5lciIsIkxheWVyUnVubmVyTWl4aW5zIiwiQmFzZVBpcGVsaW5lQ2xhc3MiLCJMYXllclJ1bm5lciIsInNhdmVQYXJhbXMiLCJsb2FkUGFyYW1zIiwiZ2V0U2F2ZWRQYXJhbUxpc3QiLCJQYXJhbWV0ZXJJbml0aWFsaXplciIsInBhcmFtZXRlckluaXRpYWxpemVyIiwic2V0QnlDb25maWciLCJwaXBlbGluZUNvbmZpZyIsIkxvZ2dlciIsImdyb3VwQmVnaW4iLCJMYXllcnMiLCJncm91cEVuZCIsInJ1bm5lciIsImxheWVyUnVubmVyIiwiX193ZWJwYWNrX2V4cG9ydHNfXyIsInBhcmFtZXRlcl9taXhpbnMiLCJwYXJhbWV0ZXJGdW5jdG9yX21peGlucyIsInJ1bm5lcl9taXhpbnMiLCJsYXllclJ1bm5lcl9taXhpbnMiXSwibWFwcGluZ3MiOiJDQUFBLFNBQUFBLEVBQUFDLEdBQ0EsaUJBQUFDLFNBQUEsaUJBQUFDLE9BQ0FBLE9BQUFELFFBQUFELEVBQUFHLFFBQUEsbUJBQUFBLFFBQUEsb0JBQUFBLFFBQUEsdUJBQ0EsbUJBQUFDLGVBQUFDLElBQ0FELE9BQUEsNERBQUFKLEdBQ0EsaUJBQUFDLFFBQ0FBLFFBQUEsb0JBQUFELEVBQUFHLFFBQUEsbUJBQUFBLFFBQUEsb0JBQUFBLFFBQUEsdUJBRUFKLEVBQUEsb0JBQUFDLEVBQUFELEVBQUEsbUJBQUFBLEVBQUEsb0JBQUFBLEVBQUEsdUJBUkEsQ0FTQ08sS0FBQSxTQUFBQyxFQUFBQyxFQUFBQyxHQUNELG1CQ1RBLElBQUFDLEVBQUEsR0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQVgsUUFHQSxJQUFBQyxFQUFBUSxFQUFBRSxHQUFBLENBQ0FDLEVBQUFELEVBQ0FFLEdBQUEsRUFDQWIsUUFBQSxJQVVBLE9BTkFjLEVBQUFILEdBQUFJLEtBQUFkLEVBQUFELFFBQUFDLElBQUFELFFBQUFVLEdBR0FULEVBQUFZLEdBQUEsRUFHQVosRUFBQUQsUUEwREEsT0FyREFVLEVBQUFNLEVBQUFGLEVBR0FKLEVBQUFPLEVBQUFSLEVBR0FDLEVBQUFRLEVBQUEsU0FBQWxCLEVBQUFtQixFQUFBQyxHQUNBVixFQUFBVyxFQUFBckIs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QyxHQUNyQnROLEtBQUtzTixxQkFBdUJBLEVBSWhDQyxZQUFZQyxHQUNMekosTUFBTXdKLGFBQ0x4SixNQUFNd0osWUFBWUMsR0FFdEJ4TixLQUFLeU4sT0FBT0MsV0FBVyw2QkFDdkIsTUFBTXZLLElBQUVBLEdBQVFxSyxHQUNWRyxPQUFFQSxFQUFGM0ssV0FBVUEsR0FBZUcsRUFDL0JuRCxLQUFLaU4sWUFBWTNDLFVBQVlxRCxFQUM3QjNOLEtBQUtxTixxQkFBdUJySyxFQUM1QmhELEtBQUtpTixZQUFZN0MsY0FBZ0JwSyxLQUFLcU4scUJBQXFCTSxHQUMzRDNOLEtBQUt5TixPQUFPRyxXQUdoQlgsZ0JBQWdCWSxHQUNaN04sS0FBSzhOLFlBQWNELEVBRXZCWixrQkFDSSxJQUFJak4sS0FBSzhOLFlBQ0wsTUFBTXBKLE1BQU0sMEJBRWhCLE9BQU8xRSxLQUFLOE4sZUN0RHBCek4sRUFBQVEsRUFBQWtOLEVBQUEsb0NBQUF0SyxJQUFBcEQsRUFBQVEsRUFBQWtOLEVBQUEsd0NBQUFuRSxJQUFBdkosRUFBQVEsRUFBQWtOLEVBQUEsb0NBQUFDLElBQUEzTixFQUFBUSxFQUFBa04sRUFBQSwyQ0FBQUUsSUFBQTVOLEVBQUFRLEVBQUFrTixFQUFBLG9DQUFBakIsSUFBQXpNLEVBQUFRLEVBQUFrTixFQUFBLGlDQUFBRyxJQUFBN04sRUFBQVEsRUFBQWtOLEVBQUEsc0NBQUFJIiwiZmlsZSI6IkBjYXVzYWxOZXQvbGF5ZXIubm9kZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZShcImNhdXNhbC1uZXQuY29yZVwiKSwgcmVxdWlyZShcImNhdXNhbC1uZXQudXRpbHNcIiksIHJlcXVpcmUoXCJjYXVzYWwtbmV0LnN0b3JhZ2VcIikpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW1wiY2F1c2FsLW5ldC5jb3JlXCIsIFwiY2F1c2FsLW5ldC51dGlsc1wiLCBcImNhdXNhbC1uZXQuc3RvcmFnZVwiXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJAY2F1c2FsTmV0L2xheWVyXCJdID0gZmFjdG9yeShyZXF1aXJlKFwiY2F1c2FsLW5ldC5jb3JlXCIpLCByZXF1aXJlKFwiY2F1c2FsLW5ldC51dGlsc1wiKSwgcmVxdWlyZShcImNhdXNhbC1uZXQuc3RvcmFnZVwiKSk7XG5cdGVsc2Vcblx0XHRyb290W1wiQGNhdXNhbE5ldC9sYXllclwiXSA9IGZhY3Rvcnkocm9vdFtcImNhdXNhbC1uZXQuY29yZVwiXSwgcm9vdFtcImNhdXNhbC1uZXQudXRpbHNcIl0sIHJvb3RbXCJjYXVzYWwtbmV0LnN0b3JhZ2VcIl0pO1xufSkodGhpcywgZnVuY3Rpb24oX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMF9fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18xX18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzJfXykge1xucmV0dXJuICIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAzKTtcbiIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMF9fOyIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMV9fOyIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMl9fOyIsImNvbnN0IERlbnNlTGF5ZXJNaXhpbnMgPSAoUGlwZWxpbmVDbGFzcyk9PiBjbGFzcyBleHRlbmRzIFBpcGVsaW5lQ2xhc3N7XG4gICAgLyoqXG4gICAgICogU2ltcGxlIGRlbnNlIGxheWVyXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGlucHV0U2l6ZSAtIHNpemUgb2YgbmV0IGlucHV0XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IG91dHB1dFNpemUgLSBzaXplIG9mIG5ldCBvdXRwdXRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ3xGdW5jdGlvbn0gYWN0aXZhdG9yIC0gYWN0aXZhdG9yIGZ1bmN0aW9uIGNhbiBiZSBjdXN0b21lZCBvciBnZXQgZnJvbSBidWlsdC1pbiBieSBzdHJpbmcgbmFtZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIC0gbGF5ZXIgbmFtZSwgZGVmYXVsdCBieSBudWxsXG4gICAgICogQHJldHVybnMgeyBPYmplY3QgfSBsYXllclxuICAgICAqL1xuICAgIGRlbnNlKGlucHV0U2l6ZSwgb3V0cHV0U2l6ZSwgYWN0aXZhdG9yPSdzaWdtb2lkJyxuYW1lPW51bGwpe1xuICAgICAgICBpZighbmFtZSl7XG4gICAgICAgICAgICBuYW1lID0gdGhpcy5uYW1lR2VuZXJhdG9yKCdkZW5zZScpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IFxuICAgICAgICAgICAgTmFtZTogbmFtZSwgVHlwZTogJ0xheWVyJyxcbiAgICAgICAgICAgIFBhcmFtZXRlcnM6IHsgV2VpZ2h0OiBbaW5wdXRTaXplLCBvdXRwdXRTaXplXSwgQmlhczogW291dHB1dFNpemVdIH0sXG4gICAgICAgICAgICBOZXQ6ICh2YWx1ZSwgcGFyYW1zKT0+e1xuICAgICAgICAgICAgICAgICAgICBsZXQgdHJhY2UgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHtXZWlnaHQsIEJpYXN9ID0gcGFyYW1zO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gdmFsdWUuZG90KFdlaWdodCkuYWRkKEJpYXMpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mIFwiYWN0aXZhdG9yXCIgPT09IFwic3RyaW5nXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0W2FjdGl2YXRvcl0oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYWN0aXZhdG9yKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH0gICBcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgcmVzdWx0LCB0cmFjZSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgfVxufTtcbmV4cG9ydCBkZWZhdWx0IERlbnNlTGF5ZXJNaXhpbnM7IiwiaW1wb3J0IHsgVGVuc29yIGFzIEJhc2VUZW5zb3IgfSBmcm9tICdjYXVzYWwtbmV0LmNvcmUnO1xuaW1wb3J0IHsgcGxhdGZvcm0gfSBmcm9tICdjYXVzYWwtbmV0LnV0aWxzJztcbmltcG9ydCB7IGRlZmF1bHQgYXMgRGVuc2VNaXhpbnMgfSBmcm9tICcuL2RlbnNlLm1peGlucyc7XG4vKipcbiAqIFRoaXMgY2xhc3MgcHJvdmlkZXMgY29tbW9uIHVzZWQgbGF5ZXJzIHdoaWNoIGNhbiBiZSBhY2Nlc3NlZCB2aWEgKipjYXVzYWxOZXRMYXllcnMqKiBpbnN0YW5jZS5cbiAqIHsgbWl4V2l0aDogWyBMYXllck1peGlucywgRGVuc2VNaXhpbnMgXSB9XG4gKiBAY2xhc3MgQ2F1c2FsTmV0TGF5ZXJzXG4gKiBAZXh0ZW5kcyBCYXNlVGVuc29yXG4gKiBAZXhhbXBsZVxuICogW0VYQU1QTEUgLi4vZXhhbXBsZXMvZGVuc2UubGF5ZXIuanNdXG4gKi9cbmNsYXNzIENhdXNhbE5ldExheWVycyBleHRlbmRzIHBsYXRmb3JtLm1peFdpdGgoQmFzZVRlbnNvciwgXG4gICAgWyBEZW5zZU1peGlucyBdICl7XG4gICAgY29uc3RydWN0b3IoKXtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5sYXllck5hbWVzID0gW107XG4gICAgfVxuICAgIG5hbWVHZW5lcmF0b3IobGF5ZXJUeXBlKXtcbiAgICAgICAgY29uc3QgbGF5ZXJJZHggPSB0aGlzLmxheWVyTmFtZXMubGVuZ3RoOyBcbiAgICAgICAgbGV0IG5ld05hbWUgPSBsYXllclR5cGUgKyAnLycgKyBsYXllcklkeDtcbiAgICAgICAgdGhpcy5sYXllck5hbWVzLnB1c2gobmV3TmFtZSk7XG4gICAgICAgIHJldHVybiBuZXdOYW1lO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgbmV3IENhdXNhbE5ldExheWVycygpOyIsImNvbnN0IFBhcmFtZXRlck1peGlucyA9IChCYXNlUGFyYW1ldGVyQ2xhc3MpPT4gY2xhc3MgZXh0ZW5kcyBCYXNlUGFyYW1ldGVyQ2xhc3N7IFxuICAgIFxuICAgIGdldCBQcmVkaWN0UGFyYW1ldGVycygpe1xuICAgICAgICBpZighdGhpcy5wYXJhbWV0ZXJzIHx8ICF0aGlzLnBhcmFtZXRlcnMuUHJlZGljdCl7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcigncGFyYW1ldGVycyBpcyBub3Qgc2V0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucGFyYW1ldGVycy5QcmVkaWN0O1xuICAgIH1cbiAgICBcbiAgICBnZXQgRW5jb2RlUGFyYW1ldGVycygpe1xuICAgICAgICBpZighdGhpcy5wYXJhbWV0ZXJzIHx8ICF0aGlzLnBhcmFtZXRlcnMuRW5jb2RlKXtcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdwYXJhbWV0ZXJzIGlzIG5vdCBzZXQnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5wYXJhbWV0ZXJzLkVuY29kZTtcbiAgICB9XG4gICAgXG4gICAgZ2V0IERlY29kZVBhcmFtZXRlcnMoKXtcbiAgICAgICAgaWYoIXRoaXMucGFyYW1ldGVycyB8fCAhdGhpcy5wYXJhbWV0ZXJzLkRlY29kZSl7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcigncGFyYW1ldGVycyBpcyBub3Qgc2V0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucGFyYW1ldGVycy5EZWNvZGU7XG4gICAgfVxuICAgIFxuICAgIHNldCBQcmVkaWN0UGFyYW1ldGVycyhwcmVkaWN0UGFyYW1ldGVycyl7XG4gICAgICAgIHRoaXMucGFyYW1ldGVycyA9ICh0aGlzLnBhcmFtZXRlcnMpPyB0aGlzLnBhcmFtZXRlcnM6IHt9O1xuICAgICAgICB0aGlzLnBhcmFtZXRlcnMuUHJlZGljdCA9IHByZWRpY3RQYXJhbWV0ZXJzO1xuICAgIH1cbiAgICBcbiAgICBzZXQgRW5jb2RlUGFyYW1ldGVycyhlbmNvZGVQYXJhbWV0ZXJzKXtcbiAgICAgICAgdGhpcy5wYXJhbWV0ZXJzID0gKHRoaXMucGFyYW1ldGVycyk/IHRoaXMucGFyYW1ldGVyczoge307XG4gICAgICAgIHRoaXMucGFyYW1ldGVycy5FbmNvZGUgPSBlbmNvZGVQYXJhbWV0ZXJzO1xuICAgIH1cbiAgICBcbiAgICBzZXQgRGVjb2RlUGFyYW1ldGVycyhkZWNvZGVQYXJhbWV0ZXJzKXtcbiAgICAgICAgdGhpcy5wYXJhbWV0ZXJzID0gKHRoaXMucGFyYW1ldGVycyk/IHRoaXMucGFyYW1ldGVyczoge307XG4gICAgICAgIHRoaXMucGFyYW1ldGVycy5EZWNvZGUgPSBkZWNvZGVQYXJhbWV0ZXJzO1xuICAgIH1cblxuICAgIHNldCBQYXJhbWV0ZXJTaXplcyhwYXJhbWV0ZXJTaXplcyl7XG4gICAgICAgIHRoaXMucGFyYW1ldGVyU2l6ZXMgPSBwYXJhbWV0ZXJTaXplcztcbiAgICB9XG5cbiAgICBnZXQgUGFyYW1ldGVyU2l6ZXMoKXtcbiAgICAgICAgaWYoIXRoaXMucGFyYW1ldGVyU2l6ZXMpe1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ3BhcmFtZXRlclNpemVzIGlzIG5vdCBzZXQnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5wYXJhbWV0ZXJTaXplcztcbiAgICB9XG4gICAgXG4gICAgZ2V0IFNhdmVNb2RlbERpcigpe1xuICAgICAgICByZXR1cm4gJ3NhdmVNb2RlbC8nO1xuICAgIH1cbiAgICBcbiAgICBleHBvcnRQYXJhbWV0ZXJzKCl7XG4gICAgICAgIGlmKCF0aGlzLnBhcmFtZXRlcnMpe1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ3BhcmFtZXRlciBpcyBub3Qgc2V0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChhc3luYyAoKT0+e1xuICAgICAgICAgICAgY29uc3QgRm4gPSBhc3luYyAocGFyYW0pPT4oQXJyYXkuZnJvbShhd2FpdCBwYXJhbS5kYXRhKCkpKTtcbiAgICAgICAgICAgIGxldCBwYXJhbXMgPSBhd2FpdCB0aGlzLmV4dHJhY3RQYXJhbUZyb21UZW5zb3JEaWN0KHRoaXMucGFyYW1ldGVycywgRm4pO1xuICAgICAgICAgICAgcmV0dXJuIHBhcmFtcztcbiAgICAgICAgfSkoKTtcbiAgICB9XG5cbiAgICBcbiAgICBhc3luYyBleHRyYWN0UGFyYW1Gcm9tVGVuc29yRGljdChwYXJhbXMsIGZuKXtcbiAgICAgICAgY29uc3QgUiA9IHRoaXMuUjtcbiAgICAgICAgY29uc3QgVHJhdmVsbGVyID0gYXN5bmMgKHBhcmFtcywgZm4pPT57XG4gICAgICAgICAgICBpZih0aGlzLmlzVGVuc29yKHBhcmFtcykpe1xuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCBmbihwYXJhbXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICBsZXQga1ZhbHMgPSBSLnRvUGFpcnMocGFyYW1zKTtcbiAgICAgICAgICAgICAgICBsZXQgcmVzID0ge307XG4gICAgICAgICAgICAgICAgZm9yKGxldCBbaywgdmFsXSBvZiBrVmFscyl7XG4gICAgICAgICAgICAgICAgICAgIHJlc1trXSA9IGF3YWl0IFRyYXZlbGxlcih2YWwsIGZuKTsgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBhd2FpdCBUcmF2ZWxsZXIocGFyYW1zLCBmbik7XG4gICAgfVxuICAgIFxuICAgIGFzeW5jIHBhcmFtZXRlcnNTdW1tYXJ5KCl7XG4gICAgICAgIGlmKCF0aGlzLnBhcmFtZXRlcnMpe1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ3BhcmFtZXRlciBtdXN0IGJlIHNldCcpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IEZuID0gYXN5bmMgKHBhcmFtKT0+QXJyYXkuZnJvbShhd2FpdCBwYXJhbS5tZWFuKCkuZGF0YSgpKTtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZXh0cmFjdFBhcmFtRnJvbVRlbnNvckRpY3QodGhpcy5wYXJhbWV0ZXJzLCBGbik7XG4gICAgfVxuICAgIFxuICAgIGluaXRQYXJhbVNpemVzQnlMYXllcnMobGF5ZXJzKXtcbiAgICAgICAgY29uc3QgUiA9IHRoaXMuUiwgVCA9IHRoaXMuVCwgRiA9IHRoaXMuRjtcbiAgICAgICAgY29uc3QgR2V0UGFyYW1TaXplID0gUi5jb21wb3NlKFIuZnJvbVBhaXJzLCBSLm1hcChwPT5bcC5OYW1lLCBwLlBhcmFtZXRlcnNdKSk7XG4gICAgICAgIGNvbnN0IFByZWRpY3RTaXplID0gR2V0UGFyYW1TaXplKEYuZ2V0SW4oWydQcmVkaWN0J10sIGxheWVycywgW10pKTtcbiAgICAgICAgY29uc3QgRW5jb2RlU2l6ZSAgPSBHZXRQYXJhbVNpemUoRi5nZXRJbihbJ0VuY29kZSddLCBsYXllcnMsIFtdKSk7XG4gICAgICAgIGNvbnN0IERlY29kZVNpemUgID0gR2V0UGFyYW1TaXplKEYuZ2V0SW4oWydEZWNvZGUnXSwgbGF5ZXJzLCBbXSkpOyBcbiAgICAgICAgdGhpcy5QYXJhbWV0ZXJTaXplcyA9IHtQcmVkaWN0U2l6ZSwgRW5jb2RlU2l6ZSwgRGVjb2RlU2l6ZX07XG4gICAgfVxuXG4gICAgaW1wb3J0UGFyYW1ldGVycyhwYXJhbU9iamVjdCl7XG4gICAgICAgIGNvbnN0IFQgPSB0aGlzLlQsIEYgPSB0aGlzLkY7XG4gICAgICAgIGxldCBwcmVkaWN0UGFyYW1PYmplY3QgPSBGLmdldEluKFsnUHJlZGljdCddLCBwYXJhbU9iamVjdCwge30pO1xuICAgICAgICBsZXQgZW5jb2RlUGFyYW1PYmplY3QgID0gRi5nZXRJbihbJ0VuY29kZSddLCBwYXJhbU9iamVjdCwge30pO1xuICAgICAgICBsZXQgZGVjb2RlUGFyYW1PYmplY3QgID0gRi5nZXRJbihbJ0RlY29kZSddLCBwYXJhbU9iamVjdCwge30pO1xuICAgICAgICBjb25zdCB7IFByZWRpY3RTaXplLCBFbmNvZGVTaXplLCBEZWNvZGVTaXplIH0gPSB0aGlzLlBhcmFtZXRlclNpemVzO1xuICAgICAgICBjb25zdCBTZXRPckluaXQgPSAoIGluaXRQcmVkaWN0LCBwYXJhbU9iamVjdCApPT57XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBGLnBhcmFtZXRlck1hcFdpdGhLZXkoKGtleXMsIHBhcmFtU2l6ZSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwYXJhbVZhbHVlID0gdGhpcy5GLmdldEluKGtleXMsIHBhcmFtT2JqZWN0LCBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBhcmFtVmFsdWUgPT09IG51bGwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBULnZhcmlhYmxlKFQucmFuZG9tTm9ybWFsKHBhcmFtU2l6ZSkuYXNUeXBlKCdmbG9hdDMyJykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVC52YXJpYWJsZShULnRlbnNvcihwYXJhbVZhbHVlLCBwYXJhbVNpemUsICdmbG9hdDMyJykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9LCBpbml0UHJlZGljdCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgdGhpcy5QcmVkaWN0UGFyYW1ldGVycyA9IFNldE9ySW5pdCggUHJlZGljdFNpemUsIHByZWRpY3RQYXJhbU9iamVjdCApO1xuICAgICAgICB0aGlzLkVuY29kZVBhcmFtZXRlcnMgID0gU2V0T3JJbml0KCBFbmNvZGVTaXplLCBlbmNvZGVQYXJhbU9iamVjdCApO1xuICAgICAgICB0aGlzLkRlY29kZVBhcmFtZXRlcnMgID0gU2V0T3JJbml0KCBEZWNvZGVTaXplLCBkZWNvZGVQYXJhbU9iamVjdCApOyBcbiAgICB9XG5cbiAgICBJbml0UGFyYW1ldGVycyhwYXJhbU9iamVjdD17fSl7XG4gICAgICAgIHJldHVybiAobGF5ZXJzKT0+e1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0T3JJbml0UGFyYW1zKGxheWVycywgcGFyYW1PYmplY3QpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIHNldE9ySW5pdFBhcmFtcyhsYXllcnMsIHBhcmFtT2JqZWN0KXtcbiAgICAgICAgdGhpcy5pbml0UGFyYW1TaXplc0J5TGF5ZXJzKGxheWVycyk7XG4gICAgICAgIHRoaXMuaW1wb3J0UGFyYW1ldGVycyhwYXJhbU9iamVjdCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGFzeW5jIGdldFNhdmVkUGFyYW1MaXN0KCl7XG4gICAgICAgIGNvbnN0IFN0b3JhZ2UgPSB0aGlzLlN0b3JhZ2UsIFNhdmVEaXIgPSB0aGlzLlNhdmVNb2RlbERpcjtcbiAgICAgICAgbGV0IGZpbGVMaXN0ID0gYXdhaXQgU3RvcmFnZS5nZXRGaWxlTGlzdChTYXZlRGlyKTtcbiAgICAgICAgcmV0dXJuIGZpbGVMaXN0Lm1hcChmaWxlTmFtZT0+ZmlsZU5hbWUucmVwbGFjZShTYXZlRGlyLCcnKSk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVBhcmFtcyhmaWxlTmFtZSl7XG4gICAgICAgIGNvbnN0IFNhdmVEaXIgPSB0aGlzLlNhdmVNb2RlbERpcjtcbiAgICAgICAgY29uc3QgU3RvcmFnZSA9IHRoaXMuU3RvcmFnZTtcbiAgICAgICAgbGV0IHBhcmFtcyA9IGF3YWl0IHRoaXMuZXhwb3J0UGFyYW1ldGVycygpO1xuICAgICAgICBhd2FpdCBTdG9yYWdlLndyaXRlRmlsZShTYXZlRGlyICsgZmlsZU5hbWUsIEpTT04uc3RyaW5naWZ5KHBhcmFtcykpO1xuICAgICAgICByZXR1cm4gcGFyYW1zO1xuICAgIH1cbiAgICBhc3luYyBsb2FkUGFyYW1zKGZpbGVOYW1lKXtcbiAgICAgICAgY29uc3QgU3RvcmFnZSA9IHRoaXMuU3RvcmFnZSwgU2F2ZURpciA9IHRoaXMuU2F2ZU1vZGVsRGlyO1xuICAgICAgICBsZXQgc3RyUGFyYW1zID0gYXdhaXQgU3RvcmFnZS5yZWFkRmlsZShTYXZlRGlyK2ZpbGVOYW1lKTtcbiAgICAgICAgbGV0IHBhcmFtcyA9IEpTT04ucGFyc2Uoc3RyUGFyYW1zKTtcbiAgICAgICAgdGhpcy5pbXBvcnRQYXJhbWV0ZXJzKHBhcmFtcyk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IFBhcmFtZXRlck1peGluczsiLCJjb25zdCBQYXJhbWV0ZXJGdW5jdG9yTWl4aW5zID0gKEZ1bmN0b3JDbGFzcyk9PiBjbGFzcyBleHRlbmRzIEZ1bmN0b3JDbGFzc3sgXG4gICAgaXNQYXJhbWV0ZXIodmFsKXtcbiAgICAgICAgY29uc3QgUiA9IHRoaXMuUjtcbiAgICAgICAgcmV0dXJuIFIuaWZFbHNlKFIuaXMoQXJyYXkpLCBSLmFsbChSLmlzKE51bWJlcikpLCBSLmFsd2F5cyhmYWxzZSkpKHZhbCk7XG4gICAgfVxuICAgIHBhcmFtZXRlck1hcFdpdGhLZXkoZm4sIHBhcmFtZXRlck9iamVjdCl7XG4gICAgICAgIGNvbnN0IFIgPSB0aGlzLlI7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBSZXMgPSAoa2V5cywgc3ViT2JqZWN0KSA9PiBSLmNvbXBvc2UoUi5mcm9tUGFpcnMsIFxuICAgICAgICAgICAgICAgICAgICAgICAgUi5tYXAoKFtrZXksIHN1Yk9iamVjdF0pPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5pc1BhcmFtZXRlcihzdWJPYmplY3QpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtrZXksIGZuKFsuLi5rZXlzLCBrZXldLCBzdWJPYmplY3QpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoUi5pcyhPYmplY3QsIHN1Yk9iamVjdCkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtrZXksIFJlcyhbLi4ua2V5cywga2V5XSwgc3ViT2JqZWN0KV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBba2V5LCBzdWJPYmplY3RdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSksIFIudG9QYWlycykoc3ViT2JqZWN0KTtcbiAgICAgICAgcmV0dXJuIFJlcyhbXSwgcGFyYW1ldGVyT2JqZWN0KTtcbiAgICB9ICAgICAgICBcbn07XG5cbmV4cG9ydCBkZWZhdWx0IFBhcmFtZXRlckZ1bmN0b3JNaXhpbnM7IiwiaW1wb3J0IHtGdW5jdG9yIGFzIEJhc2VGdW5jdG9yfSBmcm9tICdjYXVzYWwtbmV0LmNvcmUnO1xuaW1wb3J0IHtwbGF0Zm9ybX0gZnJvbSAnY2F1c2FsLW5ldC51dGlscyc7XG5pbXBvcnQge2RlZmF1bHQgYXMgUGFyYW1ldGVyRnVuY3Rvck1peGlucyB9IGZyb20gJy4vcGFyYW1ldGVyRnVuY3Rvci5taXhpbnMnO1xuXG5jbGFzcyBQYXJhbWV0ZXJGdW5jdG9yIGV4dGVuZHMgcGxhdGZvcm0ubWl4V2l0aChCYXNlRnVuY3RvciwgWyBQYXJhbWV0ZXJGdW5jdG9yTWl4aW5zIF0gKXtcbiAgICBjb25zdHJ1Y3Rvcigpe1xuICAgICAgICBzdXBlcigpO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgbmV3IFBhcmFtZXRlckZ1bmN0b3IoKTsiLCJpbXBvcnQgeyBUZW5zb3IgYXMgQmFzZVRlbnNvciB9IGZyb20gJ2NhdXNhbC1uZXQuY29yZSc7XG5pbXBvcnQgeyBwbGF0Zm9ybSB9IGZyb20gJ2NhdXNhbC1uZXQudXRpbHMnO1xuaW1wb3J0IHsgU3RvcmFnZU1peGlucywgaW5kZXhEQlN0b3JhZ2UgfSBmcm9tICdjYXVzYWwtbmV0LnN0b3JhZ2UnO1xuaW1wb3J0IHsgZGVmYXVsdCBhcyBQYXJhbWV0ZXJNaXhpbnMgfSBmcm9tICcuL3BhcmFtZXRlci5taXhpbnMnO1xuaW1wb3J0IHsgZGVmYXVsdCBhcyBwYXJhbWV0ZXJmdW5jdG9yIH0gZnJvbSAnLi9wYXJhbWV0ZXJGdW5jdG9yJztcbi8qKlxuICogVGhpcyBjbGFzcyBpcyBhIHN0YW5kYXJkIGltcGxlbWVudGF0aW9uIGZvciBtb2RlbCBwYXJhbWV0ZXJzIHdoaWNoIGNhbiBiZSBhY2Nlc3NlZCB2aWEgKipjYXVzYWxOZXRQYXJhbWV0ZXJzKiogaW5zdGFuY2VcbiAqIHsgbWl4V2l0aDogW1N0b3JhZ2VNaXhpbnMsIFBhcmFtZXRlck1peGluc10gfVxuICogQGNsYXNzIENhdXNhbE5ldFBhcmFtZXRlcnNcbiAqIEBleHRlbmRzIEJhc2VUZW5zb3JcbiAqIEBleGFtcGxlXG4gKiBbRVhBTVBMRSAuLi9leGFtcGxlL3BhcmFtZXRlcnMuYmFiZWwuanNdXG4gKi9cbmNsYXNzIENhdXNhbE5ldFBhcmFtZXRlcnMgZXh0ZW5kcyBwbGF0Zm9ybS5taXhXaXRoKEJhc2VUZW5zb3IsIFtTdG9yYWdlTWl4aW5zLCBQYXJhbWV0ZXJNaXhpbnNdICl7XG4gICAgY29uc3RydWN0b3Ioc3RvcmFnZSwgcGFyYW1ldGVyZnVuY3Rvcil7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucGFyYW1ldGVycyA9IG51bGw7XG4gICAgICAgIHRoaXMuU3RvcmFnZSA9IHN0b3JhZ2U7XG4gICAgICAgIHRoaXMuRiA9IHBhcmFtZXRlcmZ1bmN0b3I7XG4gICAgICAgIHRoaXMuUiA9IHRoaXMuRi5Db3JlRnVuY3RvcjtcbiAgICB9XG59ICAgXG5cbmV4cG9ydCBkZWZhdWx0IG5ldyBDYXVzYWxOZXRQYXJhbWV0ZXJzKGluZGV4REJTdG9yYWdlLCBwYXJhbWV0ZXJmdW5jdG9yKTsiLCIvKipcbiAqIFRoaXMgUnVubmVyTWl4aW5zIGNsYXNzIHByb3ZpZGUgbWV0aG9kcyBmb3IgcnVubmVyIGNsYXNzLlxuICogQGNsYXNzIFJ1bm5lck1peGluc1xuICogQGV4dGVuZHMgQmFzZVJ1bm5lckNsYXNzXG4gKi9cbmNvbnN0IFJ1bm5lck1peGlucyA9ICggQmFzZVJ1bm5lckNsYXNzICk9PiBjbGFzcyBleHRlbmRzIEJhc2VSdW5uZXJDbGFzc3tcbiAgICBzZXQgTmV0UGFyYW1ldGVycyhwYXJhbWV0ZXJzKXtcbiAgICAgICAgdGhpcy5uZXRQYXJhbWV0ZXJzID0gcGFyYW1ldGVycztcbiAgICB9XG4gICAgc2V0IE5ldExheWVycyhuZXRMYXllcnMpe1xuICAgICAgICB0aGlzLm5ldExheWVycyA9IG5ldExheWVycztcbiAgICB9XG4gICAgZ2V0IE5ldFBhcmFtZXRlcnMoKXtcbiAgICAgICAgaWYoIXRoaXMubmV0UGFyYW1ldGVycyl7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcignbmV0UGFyYW1ldGVycyBpcyBub3Qgc2V0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMubmV0UGFyYW1ldGVycztcbiAgICB9XG4gICAgZ2V0IE5ldExheWVycygpe1xuICAgICAgICBpZighdGhpcy5uZXRMYXllcnMpe1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ25ldExheWVycyBpcyBub3Qgc2V0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMubmV0TGF5ZXJzO1xuICAgIH1cbiAgICBydW5PcEZsb3codmFsdWUsIGZsb3csIHBhcmFtZXRlcnMpe1xuICAgICAgICBjb25zdCBSID0gdGhpcy5SO1xuICAgICAgICBjb25zdCBPcHNSdW5uZXIgPSBSLmFkZEluZGV4KFIucmVkdWNlKShSLl9fLHtyZXN1bHQ6IHZhbHVlLCB0cmFjZToge319LCBmbG93KTtcbiAgICAgICAgdmFyIHtyZXN1bHQsIHRyYWNlfSA9IE9wc1J1bm5lcigoe3Jlc3VsdCwgdHJhY2V9LCBub2RlLCBpZHgpPT57XG4gICAgICAgICAgICBpZihub2RlLlBhcmFtZXRlcil7XG4gICAgICAgICAgICAgICAgbGV0IHBhcmFtcyA9IHBhcmFtZXRlcnNbbm9kZS5QYXJhbWV0ZXJdO1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdFtub2RlLk9wXShwYXJhbXMsIC4uLm5vZGUuQXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdFtub2RlLk9wXSguLi5ub2RlLkFyZ3MpOyAgICBcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0cmFjZVtpZHhdID0gcmVzdWx0LnNoYXBlO1xuICAgICAgICAgICAgcmV0dXJuIHtyZXN1bHQsIHRyYWNlfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB7cmVzdWx0LCB0cmFjZX07XG4gICAgfVxuXG4gICAgcnVuT3BMYXllcih2YWx1ZSwgbmV0LCBwYXJhbWV0ZXJzKXtcbiAgICAgICAgbGV0IHsgcmVzdWx0LCB0cmFjZSB9ID0gbmV0KHZhbHVlLCBwYXJhbWV0ZXJzKTtcbiAgICAgICAgcmV0dXJuIHtyZXN1bHQsIHRyYWNlfTtcbiAgICB9XG4gICAgcnVuTGF5ZXIodmFsdWUsIGxheWVyQ29uZmlndXJlLCBsYXllclBhcmFtZXRlcnMpe1xuICAgICAgICBjb25zdCB7TmFtZSwgVHlwZSwgRmxvdywgTmV0fSA9IGxheWVyQ29uZmlndXJlO1xuICAgICAgICBpZihUeXBlID09PSAnVGVuc29yJyl7XG4gICAgICAgICAgICBsZXQge3Jlc3VsdCwgdHJhY2V9ID0gdGhpcy5ydW5PcEZsb3codmFsdWUsIEZsb3csIGxheWVyUGFyYW1ldGVycyk7XG4gICAgICAgICAgICByZXR1cm4ge1tOYW1lXTogcmVzdWx0LCB0cmFjZX07XG4gICAgICAgIH0gICBcbiAgICAgICAgZWxzZSBpZihUeXBlID09PSAnTGF5ZXInKXtcbiAgICAgICAgICAgIGxldCB7cmVzdWx0LCB0cmFjZX0gPSB0aGlzLnJ1bk9wTGF5ZXIodmFsdWUsIE5ldCwgbGF5ZXJQYXJhbWV0ZXJzKTtcbiAgICAgICAgICAgIHJldHVybiB7W05hbWVdOiByZXN1bHQsIHRyYWNlfTtcbiAgICAgICAgfSAgIFxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ3R5cGUgbXVzdCBiZSBlaXRoZXIgTGF5ZXIgb3IgVGVuc29yJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0cmFjaW5nKHRyYWNlcywgbmFtZSwgdHJhY2Upe1xuICAgICAgICBpZih0cmFjZXMpe1xuICAgICAgICAgICAgdHJhY2VzLnB1c2goe1tuYW1lXTogdHJhY2V9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBydW4obGF5ZXJzLCBzYW1wbGVzLCBwYXJhbWV0ZXJzLCB0cmFjZXM9bnVsbCl7XG4gICAgICAgIGxldCBwaXBlVmFsdWUgPSB7UGlwZUlucHV0OiBzYW1wbGVzfSwgbGFzdExheWVyID0gJ1BpcGVJbnB1dCc7XG4gICAgICAgIGZvcihsZXQgbGF5ZXIgb2YgbGF5ZXJzKXtcbiAgICAgICAgICAgIGxldCBsYXllck91dHB1dCA9IHRoaXMucnVuTGF5ZXIocGlwZVZhbHVlW2xhc3RMYXllcl0sIGxheWVyLCBwYXJhbWV0ZXJzW2xheWVyLk5hbWVdKTtcbiAgICAgICAgICAgIHBpcGVWYWx1ZVtsYXllci5OYW1lXSA9IGxheWVyT3V0cHV0W2xheWVyLk5hbWVdO1xuICAgICAgICAgICAgbGFzdExheWVyID0gbGF5ZXIuTmFtZTtcbiAgICAgICAgICAgIHRoaXMudHJhY2luZyh0cmFjZXMsIGxheWVyLk5hbWUsIGxheWVyT3V0cHV0LnRyYWNlKTtcbiAgICAgICAgfVxuICAgICAgICBpZih0cmFjZXMpe1xuICAgICAgICAgICAgdGhpcy5sb2dnZXIuZGVidWcoe3RyYWNlc30pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwaXBlVmFsdWVbbGFzdExheWVyXTtcbiAgICB9XG5cbiAgICBnZXQgUHJlZGljdG9yKCl7XG4gICAgICAgIGxldCBwcmVkaWN0TGF5ZXJzID0gdGhpcy5OZXRMYXllcnMuUHJlZGljdDtcbiAgICAgICAgY29uc3QgUHJlZGljdFBhcmFtZXRlcnNMZW5zZXMgPSAoKT0+dGhpcy5OZXRQYXJhbWV0ZXJzLlByZWRpY3RQYXJhbWV0ZXJzO1xuICAgICAgICByZXR1cm4gKHNhbXBsZXMpPT57XG4gICAgICAgICAgICBsZXQgcHJlZGljdFBhcmFtZXRlcnMgPSBQcmVkaWN0UGFyYW1ldGVyc0xlbnNlcygpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucnVuKHByZWRpY3RMYXllcnMsIHNhbXBsZXMsIHByZWRpY3RQYXJhbWV0ZXJzKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZ2V0IEVuY29kZXIoKXtcbiAgICAgICAgbGV0IGVuY29kZUxheWVycyA9IHRoaXMuTmV0TGF5ZXJzLkVuY29kZTtcbiAgICAgICAgY29uc3QgRW5jb2RlUGFyYW1ldGVyc0xlbnNlcyA9ICgpPT50aGlzLk5ldFBhcmFtZXRlcnMuRW5jb2RlUGFyYW1ldGVycztcbiAgICAgICAgcmV0dXJuIChzYW1wbGVzKT0+e1xuICAgICAgICAgICAgbGV0IGVuY29kZVBhcmFtZXRlcnMgPSBFbmNvZGVQYXJhbWV0ZXJzTGVuc2VzKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ydW4oZW5jb2RlTGF5ZXJzLCBzYW1wbGVzLCBlbmNvZGVQYXJhbWV0ZXJzKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZ2V0IERlY29kZXIoKXtcbiAgICAgICAgbGV0IGRlY29kZUxheWVycyA9IHRoaXMuTmV0TGF5ZXJzLkRlY29kZTtcbiAgICAgICAgY29uc3QgRGVjb2RlUGFyYW1ldGVyc0xlbnNlcyA9ICgpPT50aGlzLk5ldFBhcmFtZXRlcnMuRW5jb2RlUGFyYW1ldGVycztcbiAgICAgICAgcmV0dXJuIChzYW1wbGVzKT0+e1xuICAgICAgICAgICAgbGV0IGRlY29kZVBhcmFtZXRlcnMgPSBEZWNvZGVQYXJhbWV0ZXJzTGVuc2VzKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ydW4oZGVjb2RlTGF5ZXJzLCBzYW1wbGVzLCBkZWNvZGVQYXJhbWV0ZXJzKTtcbiAgICAgICAgfTtcbiAgICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBSdW5uZXJNaXhpbnM7XG4iLCJpbXBvcnQgeyBUZW5zb3IgYXMgQmFzZVRlbnNvciB9IGZyb20gJ2NhdXNhbC1uZXQuY29yZSc7XG5pbXBvcnQgeyBwbGF0Zm9ybSB9IGZyb20gJ2NhdXNhbC1uZXQudXRpbHMnO1xuaW1wb3J0IHsgZGVmYXVsdCBhcyBSdW5uZXJNaXhpbnMgfSBmcm9tICcuL3J1bm5lci5taXhpbnMnO1xuLyoqXG4gKiBUaGlzIENhdXNhbE5ldFJ1bm5lciBjbGFzcyBwcm92aWRlIG5ldCBleGNlY3V0b3Igd2hpY2ggaXMgcHJvdmlkZWQgcGlwZWxpbmUgaW5zdGFuY2UgYXQgKipMYXllclJ1bm5lcioqIGF0dHJpYnV0ZS5cbiAqIHsgbWl4V2l0aDogWyBSdW5uZXJNaXhpbnMgXSB9XG4gKiBAY2xhc3MgQ2F1c2FsTmV0UnVubmVyXG4gKiBAZXh0ZW5kcyBCYXNlVGVuc29yXG4gKiBAZXhhbXBsZVxuICogW0VYQU1QTEUgLi4vZXhhbXBsZXMvcnVubmVyLm1peGlucy5iYWJlbC5qc11cbiAqL1xuY2xhc3MgQ2F1c2FsTmV0UnVubmVyIGV4dGVuZHMgcGxhdGZvcm0ubWl4V2l0aChCYXNlVGVuc29yLCBbIFJ1bm5lck1peGlucyBdICl7XG4gICAgY29uc3RydWN0b3IoKXtcbiAgICAgICAgc3VwZXIoKTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IG5ldyBDYXVzYWxOZXRSdW5uZXIoKTsiLCIvKipcbiAqIFRoaXMgbWl4aW4gY2xhc3MgcHJvdmlkZSBhdHRyaWJ1dGVzOiAqKlBhcmFtZXRlckluaXRpYWxpemVyKiosICoqTGF5ZXJSdW5uZXIqKiwgXG4gKiBhbmQgaGFuZGxlICoqTmV0Kiogc2V0dGluZyBvZiBwaXBlbGluZUNvbmZpZyBcbiAqIEBjbGFzcyBMYXllclJ1bm5lck1peGluc1xuICogQGV4dGVuZHMgQmFzZVBpcGVsaW5lQ2xhc3NcbiAqIEBleGFtcGxlXG4gKiBbRVhBTVBMRSAuLi9leGFtcGxlcy9sYXllclJ1bm5lci5taXhpbnMuYmFiZWwuanNdXG4gKi9cbmNvbnN0IExheWVyUnVubmVyTWl4aW5zID0gKEJhc2VQaXBlbGluZUNsYXNzKT0+IGNsYXNzIGV4dGVuZHMgQmFzZVBpcGVsaW5lQ2xhc3N7XG4gICAgYXN5bmMgc2F2ZVBhcmFtcyhmaWxlTmFtZSl7XG4gICAgICAgIGF3YWl0IHRoaXMuTGF5ZXJSdW5uZXIuTmV0UGFyYW1ldGVycy5zYXZlUGFyYW1zKGZpbGVOYW1lKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGFzeW5jIGxvYWRQYXJhbXMoZmlsZU5hbWUpe1xuICAgICAgICB0aGlzLkxheWVyUnVubmVyLk5ldFBhcmFtZXRlcnMgPSBhd2FpdCB0aGlzLkxheWVyUnVubmVyLk5ldFBhcmFtZXRlcnMubG9hZFBhcmFtcyhmaWxlTmFtZSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGFzeW5jIGdldFNhdmVkUGFyYW1MaXN0KCl7XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLkxheWVyUnVubmVyLk5ldFBhcmFtZXRlcnMuZ2V0U2F2ZWRQYXJhbUxpc3QoKTtcbiAgICB9XG5cbiAgICBnZXQgUGFyYW1ldGVySW5pdGlhbGl6ZXIoKXtcbiAgICAgICAgaWYoIXRoaXMucGFyYW1ldGVySW5pdGlhbGl6ZXIpe1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ1BhcmFtZXRlckluaXRpYWxpemVyIGlzIG5vdCBzZXQnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5wYXJhbWV0ZXJJbml0aWFsaXplcjtcbiAgICB9XG5cbiAgICBzZXQgUGFyYW1ldGVySW5pdGlhbGl6ZXIocGFyYW1ldGVySW5pdGlhbGl6ZXIpe1xuICAgICAgICB0aGlzLnBhcmFtZXRlckluaXRpYWxpemVyID0gcGFyYW1ldGVySW5pdGlhbGl6ZXI7XG4gICAgfVxuXG5cbiAgICBzZXRCeUNvbmZpZyhwaXBlbGluZUNvbmZpZyl7XG4gICAgICAgIGlmKHN1cGVyLnNldEJ5Q29uZmlnKXtcbiAgICAgICAgICAgIHN1cGVyLnNldEJ5Q29uZmlnKHBpcGVsaW5lQ29uZmlnKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLkxvZ2dlci5ncm91cEJlZ2luKCdzZXQgTGF5ZXJSdW5uZXIgYnkgY29uZmlnJyk7XG4gICAgICAgIGNvbnN0IHsgTmV0IH0gPSBwaXBlbGluZUNvbmZpZztcbiAgICAgICAgY29uc3QgeyBMYXllcnMsIFBhcmFtZXRlcnMgfSA9IE5ldDsgXG4gICAgICAgIHRoaXMuTGF5ZXJSdW5uZXIuTmV0TGF5ZXJzID0gTGF5ZXJzO1xuICAgICAgICB0aGlzLlBhcmFtZXRlckluaXRpYWxpemVyID0gUGFyYW1ldGVyczsgICAgICAgXG4gICAgICAgIHRoaXMuTGF5ZXJSdW5uZXIuTmV0UGFyYW1ldGVycyA9IHRoaXMuUGFyYW1ldGVySW5pdGlhbGl6ZXIoTGF5ZXJzKTtcbiAgICAgICAgdGhpcy5Mb2dnZXIuZ3JvdXBFbmQoKTtcbiAgICB9XG5cbiAgICBzZXQgTGF5ZXJSdW5uZXIocnVubmVyKXtcbiAgICAgICAgdGhpcy5sYXllclJ1bm5lciA9IHJ1bm5lcjtcbiAgICB9XG4gICAgZ2V0IExheWVyUnVubmVyKCl7XG4gICAgICAgIGlmKCF0aGlzLmxheWVyUnVubmVyKXtcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdsYXllclJ1bm5lciBpcyBub3Qgc2V0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMubGF5ZXJSdW5uZXI7XG4gICAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgTGF5ZXJSdW5uZXJNaXhpbnM7IiwiZXhwb3J0IHsgY2F1c2FsTmV0TGF5ZXJzIH0gZnJvbSAnLi9DYXVzYWxOZXRMYXllcnMvaW5kZXgnO1xuZXhwb3J0IHsgY2F1c2FsTmV0UGFyYW1ldGVycywgUGFyYW1ldGVyTWl4aW5zLCBQYXJhbWV0ZXJGdW5jdG9yTWl4aW5zIH0gZnJvbSAnLi9DYXVzYWxOZXRQYXJhbWV0ZXJzL2luZGV4JztcbmV4cG9ydCB7IGNhdXNhbE5ldFJ1bm5lciwgUnVubmVyTWl4aW5zIH0gZnJvbSAnLi9DYXVzYWxOZXRSdW5uZXIvaW5kZXgnO1xuZXhwb3J0IHsgZGVmYXVsdCBhcyBMYXllclJ1bm5lck1peGlucyB9IGZyb20gJy4vbGF5ZXJSdW5uZXIubWl4aW5zJztcbiJdLCJzb3VyY2VSb290IjoiIn0=